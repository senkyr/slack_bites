<!DOCTYPE html>
<html lang="cs">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Retro kalkulačka</title>
    <style>
      :root {
        color-scheme: only light;
        font-size: clamp(14px, 1.05vw + 10px, 18px);
        --body-bg: radial-gradient(circle at top, #f7ecdf 0%, #f2d4bc 42%, #e3bca0 100%);
        --shell-highlight: #e7b29c;
        --shell-base: #c37763;
        --shell-shadow: #8f4637;
        --shell-edge: rgba(82, 37, 26, 0.6);
        --shell-padding: clamp(26px, 6vw, 40px);
        --screen-bg: linear-gradient(150deg, #fbf4df 0%, #efe2c7 55%, #dfcfb3 100%);
        --screen-border: #594334;
        --screen-text: #22170f;
        --screen-gloss: rgba(255, 255, 255, 0.42);
        --digit-glow: rgba(35, 24, 18, 0.35);
        --grid-gap: clamp(12px, 2.6vmin, 20px);
        --key-radius: clamp(14px, 3vmin, 20px);
        --key-face: linear-gradient(160deg, #f6ebdc 0%, #e3d0bc 55%, #cdb49d 100%);
        --key-shadow: #b29881;
        --key-text: #352118;
        --function-face: linear-gradient(160deg, #dfcbb6 0%, #c6ae98 52%, #af9783 100%);
        --function-text: #2f1f17;
        --operator-face: linear-gradient(160deg, #d7c7b4 0%, #bca894 55%, #a38c79 100%);
        --operator-text: #2a1b15;
        --equals-face: linear-gradient(155deg, #c96e58 0%, #ac4f3d 58%, #923f32 100%);
        --equals-shadow: #703124;
        --equals-text: #fef3e7;
        --font-family-base: "IBM Plex Mono", "Courier New", "Lucida Console", monospace;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--body-bg);
        font-family: var(--font-family-base);
        color: #33231b;
        padding: clamp(30px, 6vh, 80px) clamp(16px, 5vw, 48px);
      }

      .calculator-wrapper {
        position: relative;
        width: min(440px, 92vw);
      }

      .shell-svg {
        position: absolute;
        inset: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        filter: drop-shadow(0 26px 36px rgba(111, 57, 40, 0.35));
      }

      .calculator {
        position: relative;
        padding: var(--shell-padding);
        border-radius: clamp(34px, 9vmin, 52px);
        background: linear-gradient(135deg, var(--shell-highlight) 0%, var(--shell-base) 48%, var(--shell-shadow) 100%);
        border: 1px solid var(--shell-edge);
        display: flex;
        flex-direction: column;
        gap: clamp(20px, 4.6vmin, 32px);
        overflow: hidden;
      }

      .calculator::before {
        content: "";
        position: absolute;
        inset: clamp(6px, 1.6vmin, 12px);
        border-radius: clamp(28px, 8vmin, 42px);
        background: linear-gradient(140deg, rgba(255, 255, 255, 0.18), rgba(255, 255, 255, 0) 55%);
        pointer-events: none;
        mix-blend-mode: screen;
      }

      .branding {
        position: relative;
        display: flex;
        justify-content: space-between;
        align-items: baseline;
        font-size: 0.82rem;
        letter-spacing: 0.28em;
        text-transform: uppercase;
        color: rgba(56, 30, 20, 0.72);
      }

      .branding span:last-child {
        font-size: 0.68rem;
        letter-spacing: 0.34em;
        color: rgba(56, 30, 20, 0.54);
      }

      .indicator {
        display: grid;
        grid-template-columns: repeat(6, 1fr);
        gap: clamp(4px, 1vmin, 8px);
        padding: clamp(6px, 1.6vmin, 10px) clamp(12px, 2.8vmin, 18px);
        border-radius: clamp(14px, 3.6vmin, 20px);
        background: linear-gradient(135deg, #4f3b2f 0%, #2d2119 100%);
        box-shadow: inset 0 4px 8px rgba(0, 0, 0, 0.38), inset 0 -2px 4px rgba(255, 255, 255, 0.08);
      }

      .indicator span {
        border-radius: 6px;
        background: linear-gradient(180deg, #362821 0%, #1f1712 100%);
        box-shadow: inset 0 2px 3px rgba(255, 255, 255, 0.06);
      }

      .display {
        position: relative;
        padding: clamp(26px, 5.4vmin, 34px) clamp(22px, 5vmin, 30px);
        border-radius: clamp(20px, 4.6vmin, 28px);
        background: var(--screen-bg);
        border: 2px solid var(--screen-border);
        box-shadow: inset 0 12px 18px rgba(71, 52, 40, 0.26), inset 0 -16px 22px rgba(0, 0, 0, 0.2);
        color: var(--screen-text);
        text-align: right;
        overflow: hidden;
      }

      .display::after {
        content: "";
        position: absolute;
        inset: 0;
        background: linear-gradient(115deg, transparent 20%, var(--screen-gloss) 60%, transparent 92%);
        pointer-events: none;
        mix-blend-mode: screen;
      }

      .display-value {
        position: relative;
        font-size: clamp(2.8rem, 9vw, 3.9rem);
        font-variant-numeric: tabular-nums;
        letter-spacing: 0.18em;
        word-break: break-all;
        text-shadow: 0 3px 4px var(--digit-glow);
      }

      .keypad {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: var(--grid-gap);
      }

      button {
        border: 1px solid rgba(61, 42, 32, 0.28);
        border-radius: var(--key-radius);
        padding: clamp(16px, 4.2vmin, 22px);
        background: var(--key-face);
        color: var(--key-text);
        font-family: var(--font-family-base);
        font-size: clamp(1.05rem, 2.6vmin, 1.25rem);
        font-weight: 600;
        letter-spacing: 0.04em;
        cursor: pointer;
        transition: transform 0.12s ease, box-shadow 0.14s ease, filter 0.14s ease;
        box-shadow: inset 0 3px 4px rgba(255, 255, 255, 0.65), inset 0 -5px 8px rgba(0, 0, 0, 0.18), 0 6px 0 var(--key-shadow), 0 10px 18px rgba(47, 26, 18, 0.22);
        text-transform: none;
      }

      button:hover {
        filter: brightness(1.05);
      }

      button:focus-visible {
        outline: 3px solid rgba(255, 249, 236, 0.5);
        outline-offset: 3px;
      }

      button:active {
        transform: translateY(3px);
        box-shadow: inset 0 2px 3px rgba(255, 255, 255, 0.55), inset 0 -3px 6px rgba(0, 0, 0, 0.18), 0 3px 0 var(--key-shadow), 0 6px 12px rgba(47, 26, 18, 0.18);
      }

      .key-function {
        background: var(--function-face);
        color: var(--function-text);
      }

      .key-operator {
        background: var(--operator-face);
        color: var(--operator-text);
      }

      .key-equals {
        background: var(--equals-face);
        color: var(--equals-text);
        box-shadow: inset 0 3px 4px rgba(255, 255, 255, 0.5), inset 0 -6px 8px rgba(0, 0, 0, 0.22), 0 6px 0 var(--equals-shadow), 0 12px 18px rgba(58, 24, 18, 0.28);
      }

      .key-equals:active {
        box-shadow: inset 0 2px 3px rgba(255, 255, 255, 0.45), inset 0 -4px 6px rgba(0, 0, 0, 0.22), 0 3px 0 var(--equals-shadow), 0 6px 12px rgba(58, 24, 18, 0.24);
      }

      .key-zero {
        grid-column: span 2;
      }

      @media (max-width: 480px) {
        :root {
          --grid-gap: clamp(10px, 4vw, 14px);
          --key-radius: clamp(12px, 5vw, 18px);
        }

        .branding {
          letter-spacing: 0.2em;
        }

        button {
          font-size: clamp(0.95rem, 4vw, 1.05rem);
        }
      }
    </style>
  </head>
  <body>
    <div class="calculator-wrapper">
      <svg class="shell-svg" viewBox="0 0 420 600" aria-hidden="true">
        <defs>
          <linearGradient id="shell-edge" x1="0" y1="0" x2="1" y2="1">
            <stop offset="0%" stop-color="#f4c7b0" />
            <stop offset="55%" stop-color="#c37763" />
            <stop offset="100%" stop-color="#874335" />
          </linearGradient>
          <linearGradient id="shell-glow" x1="0" y1="0" x2="1" y2="1">
            <stop offset="0%" stop-color="rgba(255, 248, 240, 0.42)" />
            <stop offset="45%" stop-color="rgba(255, 255, 255, 0)" />
          </linearGradient>
        </defs>
        <path
          d="M48 12h324a36 36 0 0 1 36 36v504a36 36 0 0 1-36 36H48a36 36 0 0 1-36-36V48A36 36 0 0 1 48 12Z"
          fill="url(#shell-edge)"
        />
        <path
          d="M78 36h264c18.778 0 34 15.222 34 34v460c0 18.778-15.222 34-34 34H78c-18.778 0-34-15.222-34-34V70c0-18.778 15.222-34 34-34Z"
          fill="url(#shell-glow)"
          opacity="0.5"
        />
      </svg>
      <div class="calculator" role="application" aria-label="Retro kalkulačka">
        <div class="branding">
          <span>Lambda 82</span>
          <span>solar cell ready</span>
        </div>
        <div class="indicator" aria-hidden="true">
          <span></span>
          <span></span>
          <span></span>
          <span></span>
          <span></span>
          <span></span>
        </div>
        <div class="display" aria-live="polite">
          <div class="display-value" id="display-value">0</div>
        </div>
        <div class="keypad">
          <button type="button" class="key-function" data-action="clear">AC</button>
          <button type="button" class="key-function" data-action="sign">±</button>
          <button type="button" class="key-function" data-action="percent">%</button>
          <button type="button" class="key-operator" data-op="divide">÷</button>

          <button type="button" class="key-digit" data-digit="7">7</button>
          <button type="button" class="key-digit" data-digit="8">8</button>
          <button type="button" class="key-digit" data-digit="9">9</button>
          <button type="button" class="key-operator" data-op="multiply">×</button>

          <button type="button" class="key-digit" data-digit="4">4</button>
          <button type="button" class="key-digit" data-digit="5">5</button>
          <button type="button" class="key-digit" data-digit="6">6</button>
          <button type="button" class="key-operator" data-op="subtract">−</button>

          <button type="button" class="key-digit" data-digit="1">1</button>
          <button type="button" class="key-digit" data-digit="2">2</button>
          <button type="button" class="key-digit" data-digit="3">3</button>
          <button type="button" class="key-operator" data-op="add">+</button>

          <button type="button" class="key-digit key-zero" data-digit="0">0</button>
          <button type="button" class="key-digit" data-action="decimal">.</button>
          <button type="button" class="key-equals" data-action="equals">=</button>
        </div>
      </div>
    </div>
    <script>
      const displayValueEl = document.getElementById("display-value");
      const keypad = document.querySelector(".keypad");

      const state = {
        current: "0",
        previous: null,
        operator: null,
        overwrite: false,
      };

      const operators = {
        add: {
          symbol: "+",
          exec: (a, b) => a + b,
        },
        subtract: {
          symbol: "−",
          exec: (a, b) => a - b,
        },
        multiply: {
          symbol: "×",
          exec: (a, b) => a * b,
        },
        divide: {
          symbol: "÷",
          exec: (a, b) => (b === 0 ? NaN : a / b),
        },
      };

      function formatNumber(value) {
        if (!isFinite(value)) {
          return "ERROR";
        }
        const str = value.toString();
        if (Math.abs(value) >= 1e9 || Math.abs(value) < 1e-6 && value !== 0) {
          return value.toExponential(6).replace(/\.0+e/, "e");
        }
        const [integer, fraction] = str.split(".");
        const grouped = integer.replace(/\B(?=(\d{3})+(?!\d))/g, "\u2009");
        return fraction ? `${grouped}.${fraction}` : grouped;
      }

      function updateDisplay() {
        displayValueEl.textContent = state.current;
      }

      function inputDigit(digit) {
        if (state.overwrite) {
          state.current = digit;
          state.overwrite = false;
          updateDisplay();
          return;
        }
        if (state.current === "0") {
          state.current = digit;
        } else if (state.current === "-0") {
          state.current = `-${digit}`;
        } else {
          state.current += digit;
        }
        updateDisplay();
      }

      function inputDecimal() {
        if (state.overwrite) {
          state.current = "0.";
          state.overwrite = false;
          updateDisplay();
          return;
        }
        if (!state.current.includes(".")) {
          state.current += ".";
          updateDisplay();
        }
      }

      function clearAll() {
        state.current = "0";
        state.previous = null;
        state.operator = null;
        state.overwrite = false;
        updateDisplay();
      }

      function toggleSign() {
        if (state.current.startsWith("-")) {
          state.current = state.current.slice(1);
        } else if (state.current !== "0") {
          state.current = `-${state.current}`;
        }
        updateDisplay();
      }

      function toPercent() {
        const value = parseFloat(state.current.replace(/\u2009/g, ""));
        if (!isNaN(value)) {
          state.current = formatNumber(value / 100);
          state.overwrite = true;
          updateDisplay();
        }
      }

      function setOperator(op) {
        const currentValue = parseFloat(state.current.replace(/\u2009/g, ""));
        if (state.operator && state.previous !== null && !state.overwrite) {
          const result = compute(currentValue);
          state.previous = result;
          state.current = formatNumber(result);
        } else {
          state.previous = currentValue;
        }
        state.operator = op;
        state.overwrite = true;
        updateDisplay();
      }

      function compute(nextValue) {
        const operation = operators[state.operator];
        if (!operation) return nextValue;
        const prevValue = state.previous ?? 0;
        const result = operation.exec(prevValue, nextValue);
        return result;
      }

      function evaluate() {
        if (!state.operator) {
          return;
        }
        const currentValue = parseFloat(state.current.replace(/\u2009/g, ""));
        const result = compute(currentValue);
        state.current = formatNumber(result);
        state.previous = null;
        state.operator = null;
        state.overwrite = true;
        updateDisplay();
      }

      keypad.addEventListener("click", (event) => {
        const button = event.target.closest("button");
        if (!button) return;

        const { digit, action, op } = button.dataset;

        if (digit) {
          inputDigit(digit);
          return;
        }

        switch (action) {
          case "decimal":
            inputDecimal();
            break;
          case "clear":
            clearAll();
            break;
          case "sign":
            toggleSign();
            break;
          case "percent":
            toPercent();
            break;
          case "equals":
            evaluate();
            break;
          default:
            break;
        }

        if (op) {
          setOperator(op);
        }
      });

      updateDisplay();
    </script>
  </body>
</html>
