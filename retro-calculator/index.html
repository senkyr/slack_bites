<!DOCTYPE html>
<html lang="cs">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MR 610 – věrná replika</title>
    <style>
      :root {
        color-scheme: only light;
        --bg: #b55c58;
        --case: #151515;
        --face: #dedede;
        --face-edge: #bdbdbd;
        --bezel: #0f0f0f;
        --lcd-bg: #dfe8d8;
        --lcd-txt: #2b2b2b;
        --blue-key: #1f3960;
        --blue-key-txt: #e9f1ff;
        --black-key: #1c1c1c;
        --black-key-txt: #ffffff;
        --beige-key: #e6dfcf;
        --beige-key-txt: #2c2c2c;
        --red-key: #b0312d;
        --red-key-txt: #fff4f4;
        --grid-gap: 8px;
        --radius: 10px;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", Cantarell, "DejaVu Sans", sans-serif;
      }

      * { box-sizing: border-box; }

      body {
        margin: 0;
        min-height: 100vh;
        display: grid;
        place-items: center;
        background: radial-gradient(1000px 800px at 50% 20%, #c67872, var(--bg));
        padding: 24px;
      }

      .device {
        width: min(480px, 95vw);
        background: linear-gradient(#1b1b1b, var(--case));
        border-radius: 22px;
        box-shadow: 0 10px 30px rgba(0,0,0,.45);
        padding: 22px 18px 12px;
        color: #111;
      
        transition: height 200ms ease;}

      .window {
        background: var(--bezel);
        border-radius: 10px;
        padding: 10px 12px;
        box-shadow: inset 0 0 0 2px #2a2a2a, inset 0 -3px 8px rgba(0,0,0,.6);
        margin-bottom: 10px;
      }

      .lcd {
        background: var(--lcd-bg);
        color: var(--lcd-txt);
        border-radius: 6px;
        height: 48px;
        display: flex;
        align-items: center;
        justify-content: flex-end;
        padding: 0 14px;
        font-size: 34px;
        font-variant-numeric: tabular-nums;
        box-shadow: inset 0 2px 0 rgba(255,255,255,.7), inset 0 -2px 0 rgba(0,0,0,.2);
      
        transition: opacity 120ms ease-in-out;}

      .panel {
        background: linear-gradient(#efefef, #dfdfdf);
        border-radius: 8px 8px 16px 16px;
        box-shadow: inset 0 0 0 1px var(--face-edge);
        padding: 12px 14px 22px;
      }

      .switch-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 14px;
        align-items: center;
        margin-bottom: 8px;
        color: #111;
        font-size: 12px;
        letter-spacing: .08em;
      }
      .switch {
        display: grid;
        grid-template-columns: auto 1fr;
        gap: 8px;
        align-items: center;
      }
      .slot {
        position: relative;
        background: #cfcfcf;
        border: 1px solid #888;
        border-radius: 4px;
        height: 22px;
      }
      .knob {
        position: absolute;
        top: 1px; bottom: 1px;
        width: 26px;
        background: #151515;
        border-radius: 3px;
        box-shadow: inset 0 1px 0 rgba(255,255,255,.12);
        transition: left .15s ease;
      }
      .slot[data-pos="off"] .knob { left: 1px; }
      .slot[data-pos="on"] .knob { left: calc(100% - 27px); }
      .slot[data-pos="0"] .knob { left: 1px; }
      .slot[data-pos="1"] .knob { left: calc(50% - 13px); }
      .slot[data-pos="2"] .knob { left: calc(100% - 27px); }

      .grid {
        display: grid;
        grid-template-columns: repeat(5, 1fr);
        gap: var(--grid-gap);
        margin-top: 8px;
      }

      .cell { display: grid; grid-template-rows: 14px 1fr; align-items: end; }
      .label { font-size: 10px; color: #121212; text-align: center; letter-spacing: .02em; }

      .key {
        border-radius: var(--radius);
        padding: 8px;
        border: 1px solid rgba(0,0,0,.35);
        box-shadow: 0 2px 0 rgba(0,0,0,.45);
        height: 48px;
        display: grid;
        align-content: center;
        justify-items: center;
        text-align: center;
        cursor: default;
        user-select: none;
      }
      button.key { cursor: pointer; }
      .key:active { transform: translateY(1px); box-shadow: 0 1px 0 rgba(0,0,0,.45); }

      .key--blue { background: var(--blue-key); color: var(--blue-key-txt); }
      .key--black { background: var(--black-key); color: var(--black-key-txt); }
      .key--beige { background: var(--beige-key); color: var(--beige-key-txt); }
      .key--red { background: var(--red-key); color: var(--red-key-txt); }

      .primary { font-size: 14px; margin-top: 2px; font-weight: 600; line-height: 1; }

      .foot {
        display: flex; justify-content: flex-end; margin-top: 14px; color: #121212;
        font-weight: 700; letter-spacing: .08em; font-size: 26px;
      }
      .foot span { color: #1a1a1a; text-shadow: 0 1px 0 #fff; }
          /* Inner wrapper that we vertically scale only when needed */
      .device-inner { transform-origin: top center; transition: transform 200ms cubic-bezier(.2,.8,.2,1); will-change: transform; }
    </style>
  </head>
  <body>
    <div class="device" role="application" aria-label="MR 610 kalkulačka">
      <div class="device-inner">
      <div class="window">
        <div class="lcd" id="lcd">0.</div>
      </div>

      <div class="panel">
        <div class="switch-row">
          <div class="switch">
            <div>OFF&nbsp;&nbsp;ON</div>
            <div class="slot" id="sw-power" data-pos="on" aria-label="Power switch" role="switch" aria-checked="true">
              <div class="knob"></div>
            </div>
          </div>
          <div class="switch">
            <div>DEG&nbsp;RAD&nbsp;GRD</div>
            <div class="slot" id="sw-angle" data-pos="0" aria-label="Angle unit switch">
              <div class="knob"></div>
            </div>
          </div>
        </div>

        <div class="grid" id="grid">
          <!-- řada 1 -->
          <div class="cell"><div class="label">&nbsp;</div><div class="key key--blue"><div class="primary">F</div></div></div>
          <div class="cell"><div class="label">3√</div><div class="key key--blue"><div class="primary">yˣ</div></div></div>
          <div class="cell"><div class="label">Δ%</div><div class="key key--blue"><div class="primary">1/x</div></div></div>
          <div class="cell"><div class="label">[</div><div class="key key--blue"><div class="primary">(</div></div></div>
          <div class="cell"><div class="label">]</div><div class="key key--blue"><div class="primary">)</div></div></div>

          <!-- řada 2 -->
          <div class="cell"><div class="label">HYP</div><div class="key key--blue"><div class="primary">hyp</div></div></div>
          <div class="cell"><div class="label">arcsin</div><div class="key key--blue"><div class="primary">sin</div></div></div>
          <div class="cell"><div class="label">arccos</div><div class="key key--blue"><div class="primary">cos</div></div></div>
          <div class="cell"><div class="label">arctan</div><div class="key key--blue"><div class="primary">tan</div></div></div>
          <div class="cell"><div class="label">X!</div><div class="key key--blue"><div class="primary">X↔Y</div></div></div>

          <!-- řada 3 -->
          <div class="cell"><div class="label">lg</div><div class="key key--blue"><div class="primary">ln</div></div></div>
          <div class="cell"><div class="label">10ˣ</div><div class="key key--blue"><div class="primary">eˣ</div></div></div>
          <div class="cell"><div class="label">√</div><div class="key key--blue"><div class="primary">x²</div></div></div>
          <div class="cell"><div class="label">DMS</div><div class="key key--blue"><div class="primary">DEG</div></div></div>
          <div class="cell"><div class="label">→XY</div><div class="key key--blue"><div class="primary">→rα</div></div></div>

          <!-- řada 4 – paměť (červené) -->
          <div class="cell"><div class="label">δset</div><button class="key key--red" data-action="mem-sub"><div class="primary">X-M</div></button></div>
          <div class="cell"><div class="label">n(ΣX)</div><button class="key key--red" data-action="mem-clear"><div class="primary">MC</div></button></div>
          <div class="cell"><div class="label">δn-1(δn)</div><button class="key key--red" data-action="mem-recall"><div class="primary">MR</div></button></div>
          <div class="cell"><div class="label">x̄(Σx²)</div><button class="key key--red" data-action="mem-sub"><div class="primary">X-M</div></button></div>
          <div class="cell"><div class="label">DATA(DEL)</div><button class="key key--red" data-action="mem-add"><div class="primary">M+</div></button></div>

          <!-- řada 5 7–9 a minus -->
          <div class="cell"><div class="label">π</div><div class="key key--beige"><div class="primary">EEX</div></div></div>
          <div class="cell"><div class="label">&nbsp;</div><button class="key key--black" data-digit="7"><div class="primary">7</div></button></div>
          <div class="cell"><div class="label">&nbsp;</div><button class="key key--black" data-digit="8"><div class="primary">8</div></button></div>
          <div class="cell"><div class="label">&nbsp;</div><button class="key key--black" data-digit="9"><div class="primary">9</div></button></div>
          <div class="cell"><div class="label">&nbsp;</div><button class="key key--beige" data-op="-"><div class="primary">−</div></button></div>

          <!-- řada 6 4–6 a dělení -->
          <div class="cell"><div class="label">&nbsp;</div><button class="key key--beige" data-action="sign"><div class="primary">+/−</div></button></div>
          <div class="cell"><div class="label">&nbsp;</div><button class="key key--black" data-digit="4"><div class="primary">4</div></button></div>
          <div class="cell"><div class="label">&nbsp;</div><button class="key key--black" data-digit="5"><div class="primary">5</div></button></div>
          <div class="cell"><div class="label">&nbsp;</div><button class="key key--black" data-digit="6"><div class="primary">6</div></button></div>
          <div class="cell"><div class="label">&nbsp;</div><button class="key key--beige" data-op="/"><div class="primary">÷</div></button></div>

          <!-- řada 7 1–3 a násobení -->
          <div class="cell"><div class="label">&nbsp;</div><button class="key key--beige" data-action="clear"><div class="primary">C</div></button></div>
          <div class="cell"><div class="label">&nbsp;</div><button class="key key--black" data-digit="1"><div class="primary">1</div></button></div>
          <div class="cell"><div class="label">&nbsp;</div><button class="key key--black" data-digit="2"><div class="primary">2</div></button></div>
          <div class="cell"><div class="label">&nbsp;</div><button class="key key--black" data-digit="3"><div class="primary">3</div></button></div>
          <div class="cell"><div class="label">&nbsp;</div><button class="key key--beige" data-op="*"><div class="primary">×</div></button></div>

          <!-- řada 8 0 , = a plus -->
          <div class="cell"><div class="label">&nbsp;</div><button class="key key--beige" data-action="clear-entry"><div class="primary">CE</div></button></div>
          <div class="cell"><div class="label">&nbsp;</div><button class="key key--black" data-digit="0"><div class="primary">0</div></button></div>
          <div class="cell"><div class="label">&nbsp;</div><button class="key key--black" data-action="decimal"><div class="primary">,</div></button></div>
          <div class="cell"><div class="label">&nbsp;</div><button class="key key--beige" data-action="equals"><div class="primary">=</div></button></div>
          <div class="cell"><div class="label">&nbsp;</div><button class="key key--beige" data-op="+"><div class="primary">+</div></button></div>
        </div>

        <div class="foot"><span>MR 610</span></div>
      </div>
      </div>
    </div>

    <script>

      // Keep calculator at reference aspect ratio unless viewport is too short.
      // Reference image size: 1146 x 2227 (W x H) => height/width ratio ≈ 1.9445
      (function(){
        const RATIO = 2227/1146; // device height per 1px of width
        const device = document.querySelector('.device');
        const inner = document.querySelector('.device-inner');

        function num(v){ return parseFloat(v)||0; }

        function layout(){
          if (!device || !inner) return;
          // Reset to natural to measure correctly
          inner.style.transform = 'none';
          inner.style.height = 'auto';

          const w = device.clientWidth;
          const idealDeviceH = Math.round(w * RATIO);

          const cs = getComputedStyle(device);
          const padV = num(cs.paddingTop) + num(cs.paddingBottom);

          const bodyCS = getComputedStyle(document.body);
          const bodyPadV = num(bodyCS.paddingTop) + num(bodyCS.paddingBottom);
          const availDeviceH = Math.max(0, document.documentElement.clientHeight - bodyPadV);

          // Target device height and target inner visible height
          const targetDeviceH = Math.max(0, Math.min(idealDeviceH, availDeviceH));
          device.style.height = targetDeviceH + 'px';

          const naturalInnerH = inner.offsetHeight; // after reset
          const targetInnerH = Math.max(0, targetDeviceH - padV);

          const k = naturalInnerH ? (targetInnerH / naturalInnerH) : 1;
          inner.style.transform = k ? ('scaleY(' + k + ')') : 'none';
          inner.style.height = naturalInnerH + 'px';
        }

        window.addEventListener('resize', layout, { passive: true });
        window.addEventListener('orientationchange', layout, { passive: true });
        window.requestAnimationFrame(layout);
      })();
      const lcd = document.getElementById('lcd');
      const grid = document.getElementById('grid');
      const swPower = document.getElementById('sw-power');
      const swAngle = document.getElementById('sw-angle');

      const state = {
        on: true,
        current: '0',
        prev: null,
        op: null,
        overwrite: true,
      };

      function render() {
        lcd.textContent = state.on ? (state.current.replace('.', ',') + (state.current.includes('.') ? '' : '.')) : '';
        lcd.style.opacity = state.on ? '1' : '0.15';
      }

      function inputDigit(d) {
        if (!state.on) return;
        if (state.overwrite || state.current === '0') {
          state.current = d;
          state.overwrite = false;
        } else {
          state.current += d;
        }
        render();
      }
      function inputDecimal() {
        if (!state.on) return;
        if (state.overwrite) {
          state.current = '0.';
          state.overwrite = false;
        } else if (!state.current.includes('.')) {
          state.current += '.';
        }
        render();
      }
      function clearAll() {
        state.current = '0'; state.prev = null; state.op = null; state.overwrite = true; render();
      }
      function clearEntry() { state.current = '0'; state.overwrite = true; render(); }
      function sign() {
        if (!state.on) return; if (state.current === '0') return;
        state.current = String(-parseFloat(state.current)); render();
      }
      function setOp(op) {
        if (!state.on) return;
        const cur = parseFloat(state.current);
        if (state.op && state.prev != null && !state.overwrite) {
          const res = calc(state.prev, cur, state.op);
          state.current = String(res);
          state.prev = res;
        } else {
          state.prev = cur;
        }
        state.op = op;
        state.overwrite = true;
        render();
      }
      function equals() {
        if (!state.on || !state.op || state.prev == null) return;
        const res = calc(state.prev, parseFloat(state.current), state.op);
        state.current = String(res);
        state.prev = null; state.op = null; state.overwrite = true; render();
      }
      function calc(a,b,op){
        switch(op){ case '+': return a+b; case '-': return a-b; case '*': return a*b; case '/': return b===0?NaN:a/b; default: return b; }
      }

      grid.addEventListener('click', (e)=>{
        const t = e.target.closest('.key'); if(!t) return;
        const d = t.getAttribute('data-digit');
        const op = t.getAttribute('data-op');
        const action = t.getAttribute('data-action');
        if (d) return inputDigit(d);
        if (op) return setOp(op);
        switch(action){
          case 'decimal': return inputDecimal();
          case 'clear': return clearAll();
          case 'clear-entry': return clearEntry();
          case 'sign': return sign();
          case 'equals': return equals();
          case 'mem-add': case 'mem-sub': case 'mem-recall': case 'mem-clear':
            return;
        }
      });

      swPower.addEventListener('click', ()=>{
        const next = swPower.getAttribute('data-pos') === 'on' ? 'off' : 'on';
        swPower.setAttribute('data-pos', next);
        if (next === 'off') {
          // Powering off: clear all runtime state and blank the display
          state.on = false;
          state.current = '0';
          state.prev = null;
          state.op = null;
          state.overwrite = true;
        } else {
          // Powering on: start fresh like a real device
          state.on = true;
          state.current = '0';
          state.prev = null;
          state.op = null;
          state.overwrite = true;
        }
        render();
      });
      swAngle.addEventListener('click', ()=>{
        const v = swAngle.getAttribute('data-pos');
        const next = v === '0' ? '1' : (v === '1' ? '2' : '0');
        swAngle.setAttribute('data-pos', next);
      });

      render();
    </script>
  </body>
  </html>
